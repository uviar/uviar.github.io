!function(){"use strict";let r=e("hcc")?e("hcc"):0;function e(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o++){for(var s=n[o];" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(t))return s.substring(t.length,s.length)}return""}function t(){let e=!0,t=document.getElementById("wp-wysiwyg-wrap");if(!t.classList.contains("html-active")){var n=document.getElementById("wysiwyg_ifr").contentWindow.document.body.innerHTML;let e=document.getElementsByName("wysiwyg")[0];e.value=n}let o=function(e){let t=new FormData(e),n={};return t.forEach(function(e,t){n[t]=e}),n}(s);var a,n=o.wysiwyg.toString();""!==n&&"%3Cp%3E%3Cbr%3E%3C%2Fp%3E"!==n&&"%3Cp%3E%3Cbr+data-mce-bogus%3D%221%22%3E%3C%2Fp%3E"!==n||(e=!1),e&&htmlCleaner.hasOwnProperty("ajaxurl")&&(a={method:"POST",url:htmlCleaner.ajaxurl,data:o},new Promise(function(e,t){let n=new XMLHttpRequest,o=a.data,s=a.url;a.method=a.method.toUpperCase(),a.method||(a.method="GET"),o&&"object"==typeof o&&(o=Object.keys(o).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(o[e])}).join("&")),"GET"===a.method&&o&&(s=a.url+"?"+o),n.open(a.method,s),n.onload=function(){200<=this.status&&this.status<300?e(n.response):t({status:this.status,statusText:n.statusText})},n.onerror=function(){t({status:this.status,statusText:n.statusText})},"POST"===a.method&&n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.headers&&Object.keys(a.headers).forEach(function(e){n.setRequestHeader(e,a.headers[e])}),n.send(o)}).then(function(s){s&&(s=JSON.parse(s),setTimeout(function(){var e,t,n,o;!0===s.success?(u.classList.remove("hidden"),d.innerHTML=s.data.html,u.scrollIntoView(!0),l(htmlCleaner.lang[h].done),e="hcc",t=r++,n=30,(o=new Date).setTime(o.getTime()+24*n*60*60*1e3),o="expires="+o.toUTCString(),document.cookie=e+"="+t+";"+o+";path=/",!htmlCleaner.logged&&5<r&&i.classList.remove("hidden")):(d.innerHTML="",s.data.message&&l(s.data.message)),c(!1)},2e3))}).catch(function(e){e&&setTimeout(function(){e.hasOwnProperty("statusText")?l(htmlCleaner.lang[h].error+": "+e.statusText,"red"):(l(htmlCleaner.lang[h].error,"red"),console.error(e)),d.innerHTML="",c(!1)},2e3)}))}function l(e,t){let n=document.getElementsByClassName("htmlcleaner__message")[0],o=document.createElement("p");t&&(o.style.backgroundColor=t),o.innerText=e,n.appendChild(o)}function c(e){e?o.classList.add("htmlcleaner__submit_loading"):o.classList.remove("htmlcleaner__submit_loading")}let i=document.getElementById("action-block"),n=document.getElementById("goto_comments"),o=document.getElementById("htmlcleaner"),s=o.closest("form"),a=document.getElementById("wysiwyg-tmce"),m=document.getElementById("wysiwyg-html"),d=document.getElementsByClassName("htmlcleaner__textarea-result")[0],u=s.getElementsByClassName("htmlcleaner__result-box")[0];var h=s.getAttribute("data-lang");let g=new Clipboard(".htmlcleaner__copy");a.innerText=htmlCleaner.lang[h].tab_ms_office,m.innerText=htmlCleaner.lang[h].tab_html,g.on("success",function(){l(htmlCleaner.lang[h].clipboard_copy_success)}),g.on("error",function(){l(htmlCleaner.lang[h].clipboard_copy_fail)}),s.addEventListener("submit",function(e){return e.preventDefault(),c(!0),t(),!1}),n.addEventListener("click",function(e){e.preventDefault(),i.classList.add("hidden");let t=document.getElementById("comments");return t.scrollIntoView(!0),!1})}(window);